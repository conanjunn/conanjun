var donutChart=function(){"use strict";var a=function(a,b){for(var c in b)a[c]=b[c]},b=function(b){var c={ease:"quad-in-out",useTransition:!0,width:100,height:100,origin:0,padding:0,destination:360,thickness:10,transitionDelay:500,tweenThickness:!0,tweenAngle:!0,transitionDuration:1e3,transitionComplete:function(){}};return a(c,b),a(this,c),this.data=this.convertData(this.data),this.build(),this};return b.prototype={build:function(){{var a=this;this.remainder}this.outerWidth=this.width+2*this.padding,this.outerHeight=this.height+2*this.padding,this.baseArc=d3.svg.arc().outerRadius(function(b){return b.outerRadius||a.width/2}).innerRadius(function(b){return b.innerRadius||a.width/2}).startAngle(function(b){return b.startAngle||a.degreesToRadians(a.origin)}).endAngle(function(b){return b.endAngle||a.degreesToRadians(a.origin)}),this.useTransition||this.baseArc.innerRadius(function(b){return b.innerRadius||a.width/2-a.thickness}),this.chartWrap=d3.select(this.container).append("div").attr("class","chart-wrap").attr("id",this.id||null),this.chartSVG=this.chartWrap.append("svg:svg").attr("width",this.outerWidth).attr("height",this.outerHeight),this.backgroundGroup=this.chartSVG.append("svg:g").attr("transform","translate("+parseInt(this.width/2+this.padding)+","+parseInt(this.height/2+this.padding)+")"),this.backgroundArc=this.backgroundGroup.append("svg:path").datum({startAngle:this.degreesToRadians(this.origin),endAngle:this.degreesToRadians(this.destination)}).style("fill",this.bgColor||"#ebeff6").attr("d",this.baseArc),this.dataGroup=this.chartSVG.append("svg:g").attr("transform","translate("+parseInt(this.width/2+this.padding)+","+parseInt(this.height/2+this.padding)+")"),this.slices=this.dataGroup.selectAll("path").data(this.data).enter().append("svg:g").attr("class","slice"),this.arcs=this.slices.append("svg:path").style("fill",function(a){return a.color}).attr("d",this.baseArc),this.buildComplete&&"function"==typeof this.buildComplete&&this.buildComplete.call(this),this.applyTransition()},globalTransition:function(a){var b=this;this.useTransition&&this.chartWrap.transition().delay(this.transitionDelay).duration(this.transitionDuration).ease(this.ease).each(a).transition().each("start",function(){b.transitionComplete.call(b)})},applyTransition:function(){var a=this;this.globalTransition(function(){var b=a.degreesToRadians(a.origin),c=d3.interpolate(a.tweenThickness?0:a.thickness,a.thickness);a.arcs.transition().attrTween("d",function(d){var e=d3.interpolate(a.tweenAngle?b:d.startAngle,d.startAngle),f=d3.interpolate(a.tweenAngle?b:d.endAngle,d.endAngle);return function(b){return d.startAngle=e(b),d.endAngle=f(b),d.innerRadius=a.width/2-c(b),a.baseArc(d)}}),a.backgroundArc.transition().attrTween("d",function(b){return function(d){return b.innerRadius=a.width/2-c(d),a.baseArc(b)}})})},degreesToRadians:function(a){return a*Math.PI/180},convertData:function(a){for(var b,c,d,e,f=this.degreesToRadians(this.origin),g=a.total,h=[],i=0;i<a.values.length;i++){d=a.values[i],b=f+this.degreesToRadians(d.n/a.total*(this.destination-this.origin)),c={startAngle:f,endAngle:b,percent:Math.round(d.n/a.total)};for(e in d)c.hasOwnProperty(e)||(c[e]=d[e]);f=b,g-=d.n,h.push(c)}return this.total=a.total,this.remainder=g,h}},b}();